---
# Choose from this list of Journals:
journal: "Water Resources Research"
# Use draft to submit a paper
classoption: "draft,linenumbers"
title: "Water Level Errors and their Impact on True Water Level Uncertainty"
# First name or initial followed by last name
authors:
  - name: Joseph P. Shannon
    affil: 1
    thanks: Joe's Thanks
  # - name: Fred T. Secondauthor
  #   affil: 1
  #   thanks: "Current address: Some other place, Germany"
  # - name: I. Ken Groupleader
  #   affil: "1, 2"
affiliations:
  - number: 1
    name: "Michigan Technological University, College of Forest Resources and Environmental Science"
  # - number: 2
  #   name: "The second affiliation"
corresponding_author:
  - name: Joseph P. Shannon
    email: jpshanno@mtu.edu
keypoints:  
  - "List up to three key points (at least one is required)"
  - "Key Points summarize the main points and conclusions of the article"
  - "Each must be 100 characters or less with no special characters or punctuation"
abstract: "A good abstract will begin with a short description of the problem being addressed, briefly describe the new data or analyses, then briefly states the main conclusion(s) and how they are supported and uncertainties."
plain_language_summary: "Some journals require a plain language summary. See: https://publications.agu.org/author-resource-center/text-requirements/#abstract"
output: 
    bookdown::word_document2:
    bookdown::pdf_document2:
      base_format: rticles::agu_article
bibliography: "`r rbbt::bbt_write_bib('biblio.bib', translator = 'bibtex', overwrite = TRUE)`"
header-includes: 
      - \usepackage{soulutf8}  # For UTF8 chars in TrackChanges
# AGU recommends using the trackchanges LaTeX package in the edition process
# which is available from this link:
# https://publications.agu.org/files/2019/02/January-14-2019-latex-templates.zip
---

```{r echo=FALSE}
library(drake)
library(data.table)
# Some recommended settings. 
knitr::opts_chunk$set(
  echo = FALSE,
  fig.pos = 'h',
  out.extra = "",   # To force the use of figure enviroment
  fig.cap = "Please caption every figure"
)
```

```{r keypoints_check, echo=FALSE, results='asis', eval = TRUE}
# This chunk adds a warning if any keypoint is longer than 100 characters. 
# To disable it, you can remove it or set eval to FALSE.
if (any(nchar(rmarkdown::metadata$keypoints) > 100)) {
  cat("\\textcolor{red}{\\textbf{Warning}: keypoint(s)", 
      knitr::combine_words(which(nchar(rmarkdown::metadata$keypoints) > 100)), 
      "longer than 100 characters.}")
}
```

# Notes

Say if the manufacturers state the source of the errors. What causes the error,
and why do I need to still compensate for it.

Figure 1 explanation: state more clearly that it is two interacting errors, not
delta T. State how some models may not be counteracting, but instead will be
compounding

Figure 3: Add panel C showing what is in Panel 4. Panel A + Panel B = Panel C.
Panel B shows no pattern and errors within range of instrument error, might be
good to build up into a relationship for Figure 1

Put uncertainty things first in the introduction and methods. Expand uncertainty
in introduction. In other words, focus on the uncertainty discussion and what it
means for diurnal signals. That is the novel work

# Introduction

Hydrologic monitoring for research and management, including monitoring wells,
piezometers, and stream discharge, often utilizes submerged pressure-transducer
to measure water levels. These instruments are easy to deploy, require minimum
access to the instrument, and provide long-term continuous records in an easily
analyzed format via on-board datalogging. They have been developed in two major
configurations: absolute or unvented, and gauge or vented. Absolute transducers
measure pressure relative to some fixed pressure contained on one side of a
flexible membrane. Gauge transducers measure pressure across a similar membrane
relative to a chamber connected to the atmosphere via a vent tube. Speaking
generally of pressure transducers in hydrologic monitoring, it has been pointed
out that "these systems commonly are not adequately supported by
quality-assurance procedures." [@freeman-2004, p. 1]. And upon studying the
impacts of temperature and temperature gradients on water level measurement
errors @liu-2015 (p. 72) concluded that "measurement of the
water level...is not simple". Even the relatively simple task of measuring water
level in a tank may be confounded by propagating instrument uncertainty through 
to final water levels [@tamari-2010]. 

In the above quote @liu-2015 were commenting on additional uncertainty that
absolute temperature and temperature gradients introduce into water level
measurements. @freeman-2004 went highlighted water temperature gradients as a
potential source of error, and in the same year @cain-2004 examined
temperature-derived artifacts within gauge transducers. Within absolute
transducers artifacts were shown to arise from the temperature of instrument
[@moore-2016], as well as from differing thermal regimes between barometric and
water pressure instruments [@cuevas-2010; @mclaughlin-2011]. @liu-2015 and 
@moore-2016 go on to suggest that all transducers be tested for inaccuracies
over the range of temperature measurements and individual compensation equations
be developed to apply to collected data.

@mclaughlin-2011 concluded that temperature differentials between water and
barometric pressure measurements introduced detectable artifacts with a 1.5 cm
increase in the diurnal variation. This result is similar to @cuevas-2010, who
found a 19% increase in streamflow diurnal fluctuation when barometric and water
transducers were deployed in different thermal settings. Both
@mclaughlin-2011 and @cuevas-2010 focused on absolute transducers, but similar
work has also been performed using vented gauge transducers. @cain-2004 found
that temperature changes within the vent-tube of gauge pressure transducers
introduce water level artifacts, which was explored further by
@liu-2015 in multi-day laboratory and long-term field experiments. Their
findings show that errors can be introduced due to water temperature or rapid
fluctuations in air temperature. Their laboratory experiment found 1.4
$mm^oC^{-1}$ error as water temperature changed (with constant air temperature).
These corrections corresponded to errors of up to 7mm in their field
experiments, with at least some of that error due to the rate of temperature
change affecting the connection to the atmosphere via the vent tube. We can
expect that errors will be introduced with more rapid temperature fluctuations
They also highlight the impact of rate of temperature change, with more rapid
gradients inducing larger water level errors. Errors due to rapid temperature
flucations can be expected to affect both absolute and gauge transducers as
internal electronics and membranes must equilibrate to the new temperatures
[@freeman-2004].

Based on those studies the potential sources of error for absolute transducers 
are the water temperature, the air temperature, the difference between water and
air temperature, and the rate of change for both water and air temperature. 
Previous studies have examined absolute transducer error due to individual 
transducer error [@moore-2016] and due to temperature differences between transducers [@mclaughlin-2011]. @liu-2015 lays out the underlying physics that could lead to 
gauge transducer errors when a temperature difference exists along the vent tube.
There is no analagous physical process for absolute transducers, which suggests 
that errors assumed to arise from temperature differences in these studies may 
be misattributed. We present the alternative hypothesis that that perceived 
temperature difference error is the combination of individual transducer 
responses to water and air temperatures (Figure \@ref(fig:figure-1)). 
The out of phase variation in air temperature and water temperature result in 
the stronger gradient masking the effect of the weaker gradient. The sequential 
correction shown in Figure \@ref{fig:figure-1} illustrates how both errors must 
be addressed. There are two possible approaches to the correction. Develop univariate 
corrections to some reference pressure measurement for each transducer, or develop
a single multi-variate correction for each pair of air and water transducers. By
developing a single multi-variate correction we can avoid the need to determine
a suitable reference pressure measurement or utilize a pressure chamber.

__Figure 1 should be what the description of figure 3 above says. Show error 
from air temp and uncorrected error from water temp. Then show error as corrected
for air and water temp.__

```{r figure-1, fig.cap="Figure 1: Water level error as function of water temperature recorded by the instrument. The line sequential connects the data point and the line color indicates the temperature difference between the water and air. The black point represents the start of the experimental period with a clockwise hystersis loop. The dashed lines represent the combined errors of the water pressure transducer and F3311 barometric sensor."}

knitr::include_graphics("../output/figures/figure_1.png")

```

Implied in the above studies is additional error, beyond instrument accuracy,
that should be considered in the estimate of total measurement uncertainty. It
is also clear that temperature-induced errors will be most apparent in field
data when examining diurnal signals. Many studies have relied on the diurnal
signal in well water levels and streamflow to estimate evapotranspiration and
groundwater flow [@carlsonmazur-2014;
@kirchner-2009; @loheide-2005; @mclaughlin-2014; @watras-2017; @white-1932].
Ignoring errors in diurnal signals will lead to additional skewed results as the
initial inaccuracies compound. Therefore, correcting for temperature-induced
errors is essential to ensure that the observed fluctuations are real and not an
artifact. Cuevas [-@cuevas-2010] and Gribovszki [-@gribovszki-2013] do validate
their measurements with manual readings over the course of at least one 24-hour
period. To be fully effective in field studies, these types of diurnal
fluctuation validations would have to happen across the range of temperature and
evapotranspiration/groundwater measurements throughout the monitoring period.
This is often unfeasible for reasons related, but not limited to, budget,
logistics, and safety. This leaves laboratory-derived compensation equations as
the best alternative option, as recommended by Moore [-@moore-2016] and Liu
[-@liu-2015].

While compensation equations can provide more assurance that observed diurnal
signals are real, they introduce addtional error beyond instrument accuracy,
that should be considered in the estimate of total measurement uncertainty. No
studies to date examining the combined impact of instrument error and
compensation equation uncertainty have been carried out to estimate the full
uncertainty of measurements. In order to assess the validity of diurnal signals
within water level measurements, any uncertainty in correcting the intra- and
inter-transducer artifacts, should be propagated through to the final water
level record. Such propagated uncertainty will provide a detection limit for
true diurnal signals. Without additional validation (through manual measurements
or other instrumentation), diurnal patterns below this detection limit must be
considered artifacts. As such we suggest that estimates of diurnal signal should
be analyzed as a left-censored dataset, with the detection limit determined by
the specifics of instrumentation and compensation equations.

In this note we present a lab experiment to isolate and correct the separate
impacts of transducer response to water and air temperatures. We demonstrate how
these effects may mask one another resulting in water level errors within the
range of instrument error. We present the corrected and uncorrected water levels
on a test set of laboratory data at as well representative data from an ongoing
hydrologic field study. Finally we calculate the propagated uncertainty, compare
this to instrument error, and evaluate both against published diurnal water
level fluctuations.

# Materials and Methods

## Data Collection & Preparation

### Laboratory Data

We have conducted a five day-long experiment recording constant water levels 
using absolute pressure transducers in four thermal settings to determine the
impact of varying water and air temperatures, and temperature difference. The
thermal settings represent a fully crossed design with stable and variable
temperatures and similar and dissimilar air and water thermal regimes. Eighteen
pressure transducers of varying age and model, all manufactured by Solinst, Ltd.
(Georgetown, ON, Canada), were used to record water levels
(Table \@ref(tab:loggers)). Two of these transducers, both Solinst Levellogger Juniors,
were used to monitor barometric pressure. All instruments contained an absolute
pressure transducer, temperature sensor, and on-board data logging. These loggers
also provide internal temperature compensation of pressure measurements. 

```{r experiments, eval = FALSE}
experiments <- 
  data.table(Experiment = c("stat-sim", "stat-dis", "var-sim", "var-dis", "test-data"),
             Temperature = c("Stable", "Stable", "Variable", "Variable", "Variable"),
             `Air/Water Temperature Differential` = c("Similar", "Dissimilar", "Similar", "Dissimilar", "Dissimilar"))

knitr::kable(experiments,
             align = "c",
             caption = "Description of experimental conditions.")
```

```{r loggers}
drake::loadd(logger_metadata)
knitr::kable(logger_metadata[, .(`Number of Loggers` = .N, `Pressure Resolution (cm)` = mean(pressure_resolution_cm), `Pressure Error (cm)` = mean(pressure_error_cm), `Temperature Resolution (C)` = mean(temperature_resolution_cm), `Temperature Error (C)` = mean(temperature_error_c)), by = .(Model = instrument_type)],
             align = "c",
             caption = "Summary of pressure transducer model type, measurement resolution, and associated errors expressed as standard deviation, derived from manufacturer stated 99% instrument accuracy.")
```

Water level transducers were suspended from a brace across a large container
with the transducers zero points aligned. The transducers were covered with a
fixed depth of water and a layer of canola oil was added to prevent evaporation
over the length of the experiment. Water level was measured at the start and end
of the experimental period to confirm no evaporation. To provide thermally
similar air and water environments we placed a graduated cylinder in the center
of the water. The cylinder was partially filled with gravel and water to
counteract the buoyancy of the cylinder. During the two periods with synchronous
thermal regimes the two barometric transducers were suspended directly above the
gravel surface. The entire apparatus was covered loosely with aluminum foil to
prevent direct wind effects. For stable thermal regimes the experiment was
conducted in a non-climate controlled basement to minimize diurnal temperature
fluctuations. Varying thermal regime periods were conducted outdoors, out of
direct solar radiation. The barometric transducers were placed under a black
radiation shield to magnify temperature differentials and purposely induce
errors from rapid temperature fluctuations [@liu-2015]. Compensation models 
(below) were developed using one day of recorded data in the variable, dissimilar
conditions. Compensation model performance was than evaluated against the 
remaining data to evaluate the impact of compensation under various transducer
deployment scenarios.

Transducers were deployed and data retrieved using using Solinst Levellogger v.
4.4.0 software. Transducers were set to record at 1-minute intervals with time
synchronized to computer time at launch. The four experiments were run serially
without retrieving data from the Transducers A settling time of at least 30
minutes was observed after barometric transducers or entire experimental apparatus
were relocated, and exact experiment start and end times were determined in a
post-hoc manner to ensure a suitable setting period.

### Field Data

A sample of representative data were taken from ongoing hydrologic field
research. These data are from a study in the western Upper Peninsula of Michigan
in sites located in black ash wetlands. Details on the hydrology of these sites
can be found in Van Grinsven _et al_ [-@vangrinsven-2017]. The data used in this
analysis are from well water levels collected from a 1.25" driven monitoring
well in a wetland and a 6" parshall flume on an intermittent stream which serves 
as the outflow of this headwater wetland. Well level, flume level, and barometric
data were collected with instruments ######, ######, and ###### respectively. 
Data were collected between ########## and ######## and recorded at 15-minute 
intervals.

## Water Level Compensation

All of the sensors used in this study are designed to measure pressure at a
relatively constant temperature and utilize a fixed water density of 1000 $kg
m^{-3}$ to convert pressure to depth (Personal Communication, Solinst). To
account for the larger range of temperatures observed in this study the recorded
pressure was adjusted to account for the variable density of water. 
$$P_{c} = P\;\mathsf{x}\;\frac{\rho_o}{\rho_T}$$ 
where $\rho_T$ is the density of water ($kg m^) as a
function of temperature taken from [@tanaka-2001, Eq. 1], $\rho_o$ is the assumed
density of water (1000 $kgm^{-3}$, and _P_ and $P_c$ are the observed and 
density-corrected pressure readings in units of depth (cm for this study). Here 
after all references to transducer pressure will refer to the density-compensated
pressure. 

Depth of water ($W_d$) was measured separately for each transducer from the water 
surface to the transducer zero point. Raw water level was calculate for each
water and air transducer pair (n = 36) as the absolute measured water pressure 
minus the absolute air pressure ($L = P_w - P_a$). Water level error 
($\epsilon_L$) was calcuated as calculated water level minus measured water 
depth.

To perform compensation without utilizing a reference pressure, a multivariate
ordinary least squares model was pair of water and air transducers. The 36 models
took the form 
$$\epsilon_L=\beta_0 + \beta_aT_a + \beta_wT_w + \beta_{\Delta T_a}\Delta T_a$$
where $T_a$, $T_w$, and $\Delta T_a$ represent air temperature, water temperature,
and change in air temperature ($^oC\;min^{-1}$) respectively. 

To avoid compensating unimpacted loggers, all $\beta$ terms with a p-value > 0.05 were 
set to zero prior to applying the compensation to the test data. For each 
water-air transducer pair the correct compensation model was used to predict the 
error ($\hat\epsilon_L$), which was used to compensate the recorded water levels 
such that
$$L_c = L - \hat\epsilon_L$$
where $L_c$ denotes the compensated water level. Both $L$ and $L_c$ were then
centered by subtracting the mean of $\epsilon_L$ and $\hat\epsilon_L$, 
respectively.

## Compensation Evaluation

To ensure independent evaluation of compensation, the accuracy of the models were
evaluated using the 4 days of data from each of the experimental periods described
above. Compensation were evaluated based on two criteria: number of
recorded points which fell outside of the range of combined instrument errors
($n_{\epsilon,i}$) and the median absolute deviation (MAD) from the true values 
as a percentage of the true value. Differences were tested using ANOVA with a
post-hoc Tukey HSD analysis to compare between correction methods.

The purpose of developing transducer compensations is to correct field-collected
data where true water level is unknown except for a relatively small collection
of manual calibration reading. Representative data from
ongoing field research using these same instruments is evaluated using raw and
compensated water levels. As true water depth was known for so few of the
recorded water level measurements, $n_{\epsilon,i}$ and MAD were not calculated.
Rather key charactersitics of the resulting time series, magnitude of the 
diurnal fluctuation, timing of water level peaks and drawdown, and daily summary
statistics, are compared. These metrics were chosen to illustrate the impact of
compensation on common metrics used in reported hydrologic data.

## Uncertainty Analysis

To determine the amount of uncertainty temperature compensation adds to water 
level measurements the Equation 2 was fit using a Baysian framework which 
propagated instrument uncertainty and regression uncertainty into the final 
estimate of $\hat\epsilon_L$. For this model each observation is considered to come from a
normally distributed dataset centered on the recorded value with a standard
deviation derived from the stated accuracy and precision of the instruments (Table \@ref{tab-loggers}). Utilizing this framework we also explore the magnitude of
uncertainty introduced by instrument error, compensation model, and thermal 
regime.

$$N(\epsilon_L, \tau_L)=\beta_0 + \beta_aN(T_a,\tau_a) + \beta_wN(T_w,\tau_w) + \beta_{\Delta T_a}N(\Delta T_a)$$

## Software
All data processing and analysis was performed in R [@rcoreteam-2019] using the
packages `data.table` [@dowle-2019] for data manipulation, `ggplot2`
[@wickham-2016] and `patchwork` [@pedersen-2019a] for visualization, `brms`
[@burkner-2017; @burkner-2018] for Bayesian uncertainty analysis, and `httr` 
[@wickham-2019a] for Mesonet API access and caching. The `drake` [@landau-2018],
`rmarkdown` [@allaire-2020; @xie-2018], `rticles` [@allaire-2019], and `rbbt`
[@dunnington-2020] packages were used to generate a reproducible project and
publication.


# Results

We saw that the different thermal regimes in the experiments could still be 
explained by a single unified model.

There was a storm that came through, could have strong pressure gradient
One barologger found resting on gravel/in water in cylinder during variable,
similar experiment.

There should be some variability in the error around points, and if I can 
demonstrate how that varies with the difference between air and water temperature
then I could actually quantify the uncertainty you add to your measurements when
you do not have your loggers in thermally similar regimes



# Conclusions
Could need a greater range of temperatures during var-sim to really check for
temperature impacts.

When correcting the barometric data knowing the air temperature difference is
important because it provides the threshold for usable data for the correction
models. You can then discard the data where temperature difference is above the
threshold and expect your final predictions to have higher errors where
temperature difference is greater.


Highlight areas where different artifacts are present. Then it can be a guide for
where people should at their data to find artifacts.

Separate out sensor-specific corrections vs generic corrections. Do any appear
to be

Separate air and water temperature responses are importantly different than a
single temperature difference model. Each logger behaves independently and 
WT = 15, AT = 25 may be different than WT = 5, AT = 15 and WT = 10, AT = 20

Multivariate approach vs single steps to reference: multivariate has the 
advantage of not introducing an additional instrument uncertainty into the 
compensation. 

**Why Perform these Corrections?**
One could argue that it’s not worth the additional uncertainty for a reduction
in points outside of the measurement error range. There are three arguments
against this. The first is the idealistic argument that we should want the
correct data for the correct reason. Have measurements stay within the error
bounds due to competing biases is not a good strategy from an idealistic or a
pragmatic view. The points that are most likely to lie outside of the error
bounds have the greatest temperature difference between transducers or show the
fastest rate of change. These are often significant events: changes in flow
following a storm or periods of peak ET where water temperature and air
temperature are likely to be at their maximum. Building on these two reasons is
that an understanding of the true uncertainty of  measured data will allow more
critical and accurate interpretation. How strong are the diurnal signals in
relation to known uncertainty.



Temperature compensation could be overstated based on the time scale of the
study. Would have to know how quickly Solinst changes temperatures in their
calibrations. [@freeman-2004] talks about this stating that it could be a rate
of change issue and/or the fact that parts of the electronics may change
temperatures at different times. Relatedly, it is important to note that these
rapid temperature changes were short-lived and the offset of the $\Delta T$
models may decline over time much as an intervention effect in a time series
model. We tested this on inter-experiment data excluded from this analysis and
found that ... (move from outside to inside for stat-dis and the long gradual
decrease in temperature after a short rapid change)

The authors have chosen to focus on trend correction rather than offset. In 
general systematic offsets are corrected through manual calibration measurements
during deployment. If deployed conditions will not allow for manual calibration
measurements, the above approaches are applicable, but offsets must be carefully
calculated. This will involve know the exact elevation difference between 
the instrument supplying reference pressure measurements and pressure transducers
during calibration.

I cannot compare if the water level errors are of fixed magnitude or percentage
based. I could make some educated guess from the barometric transducers though.

## Recommendations

- We have shown that even with the added uncertainty of rectified barometric
pressure we can provide water level compensations that match those from an
external, reference source. However it is important that during data processing
other stations were found to have different slopes for temperature correction 
models. For use in future work it is recommended that the relationship be 
developed individually for any external stations that may be used to back-fill
missing experimental or monitoring data. Or inversely that back-fill sources
are corrected to match your pressure transducers.

- For each new transducer check for *all* potential error-inducing sources. Each 
transducer should be checked for temperature gradients, temperature difference
gradients to reference values, and rate of change of temperature or pressure

- In this study no mean offset was necessary to account for persistent pressure
errors due to rapid water temperature changes. This is likely because of the
buffered $\Delta T_w$ relative to $\Delta T_a$. In setting where rapid changes
in water temperature are possible calibration should consider including a
persistent impact.

\acknowledgments
The acknowledgments must list:
A statement that indicates to the reader where the data
supporting the conclusions can be obtained (for example, in the
references, tables, supporting information, and other databases).

All funding sources related to this work from all authors

Any real or perceived financial conflicts of interests for any author

Other affiliations for any author that may be perceived as having a conflict of 
interest with respect to the results of this paper.

It is also the appropriate place to thank colleagues and other contributors.

AGU does not normally allow dedications. 

# References

\begin{notation}
\notation{$a+b$} Notation Definition here
\notation{$e=mc^2$}
Equation in German-born physicist Albert Einstein's theory of special
relativity that showed that the increased relativistic mass ($m$) of a
body comes from the energy of motion of the body—that is, its kinetic
energy ($E$)—divided by the speed of light squared ($c^2$).
\end{notation}

<!-- Or section title might be a descriptive heading about the results -->

<!-- Enter Figures and Tables near as possible to where they are first mentioned: -->
<!-- DO NOT USE \\psfrag or \\subfigure commands. -->
<!-- DO NOT USE \\newcommand, \\renewcommand, or \\def, etc. -->

<!-- ```{r} -->
<!-- plot(pressure) -->
<!-- ``` -->

<!-- Example table -->

<!-- \begin{table} -->
<!--  \caption{Time of the Transition Between Phase 1 and Phase 2$^{a}$} -->
<!--  \centering -->
<!--  \begin{tabular}{l c} -->
<!--  \hline -->
<!--   Run  & Time (min)  \\ -->
<!--  \hline -->
<!--    $l1$  & 260   \\ -->
<!--    $l2$  & 300   \\ -->
<!--    $l3$  & 340   \\ -->
<!--    $h1$  & 270   \\ -->
<!--    $h2$  & 250   \\ -->
<!--    $h3$  & 380   \\ -->
<!--    $r1$  & 370   \\ -->
<!--    $r2$  & 390   \\ -->
<!--  \hline -->
<!--  \multicolumn{2}{l}{$^{a}$Footnote text here.} -->
<!--  \end{tabular} -->
<!--  \end{table} -->

<!-- AGU prefers the use of {sidewaystable} over {landscapetable} as it causes fewer problems. -->

<!-- ```{r, fig.env = "sidewaysfigure"} -->
<!-- plot(pressure) -->
<!-- ``` -->

<!-- \begin{sidewaystable} -->
<!-- \caption{Caption here} -->
<!-- \label{tab:signif_gap_clos} -->
<!-- \begin{tabular}{ccc} -->
<!-- one&two&three\\ -->
<!-- four&five&six -->
<!-- \end{tabular} -->
<!-- \end{sidewaystable} -->

<!-- If using numbered lines, please surround equations with \\begin{linenomath\*}... \\end{linenomath\*} -->

<!-- \begin{linenomath*} -->
<!-- \begin{equation} -->
<!-- y|{f} \sim g(m, \sigma) -->
<!-- \end{equation} -->
<!-- \end{linenomath*} -->
